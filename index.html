<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blood of the Ronin</title>
<style>
body {
    margin: 0;
    overflow: hidden;
    background: black;
}
canvas {
    display: block;
    background: #111;
}
</style>
</head>
<body>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

let player = {
    x: canvas.width/2,
    y: canvas.height/2,
    size: 24,
    speed: 3,
    targetX: null,
    targetY: null
};

let enemy = {
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    size: 24,
    speed: 1.5
};

let ATTACK_RANGE = 50;
let gameOver = false;

function distance(x1,y1,x2,y2){
    return Math.hypot(x1-x2, y1-y2);
}

function spawnEnemy(){
    enemy.x = Math.random() * canvas.width;
    enemy.y = Math.random() * canvas.height;
}

function update(){

    if(gameOver) return;

    if(player.targetX !== null){
        let dx = player.targetX - player.x;
        let dy = player.targetY - player.y;
        let dist = Math.hypot(dx, dy);

        if(dist > player.speed){
            player.x += (dx/dist) * player.speed;
            player.y += (dy/dist) * player.speed;
        } else {
            player.targetX = null;
            player.targetY = null;
        }
    }

    let dx = player.x - enemy.x;
    let dy = player.y - enemy.y;
    let dist = Math.hypot(dx, dy);

    if(dist > 0){
        enemy.x += (dx/dist) * enemy.speed;
        enemy.y += (dy/dist) * enemy.speed;
    }

    if(distance(player.x,player.y,enemy.x,enemy.y) < player.size){
        gameOver = true;
    }
}

function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);

    ctx.fillStyle = "red";
    ctx.fillRect(player.x-player.size/2, player.y-player.size/2, player.size, player.size);

    ctx.fillStyle = "white";
    ctx.fillRect(enemy.x-enemy.size/2, enemy.y-enemy.size/2, enemy.size, enemy.size);

    if(gameOver){
        ctx.fillStyle = "red";
        ctx.font = "40px Arial";
        ctx.textAlign = "center";
        ctx.fillText("YOU DIED - TAP TO RESTART", canvas.width/2, canvas.height/2);
    }
}

function loop(){
    update();
    draw();
    requestAnimationFrame(loop);
}

canvas.addEventListener("click", function(e){

    if(gameOver){
        gameOver = false;
        spawnEnemy();
        player.x = canvas.width/2;
        player.y = canvas.height/2;
        return;
    }

    let rect = canvas.getBoundingClientRect();
    let x = e.clientX - rect.left;
    let y = e.clientY - rect.top;

    if(distance(x,y,enemy.x,enemy.y) < 40 &&
       distance(player.x,player.y,enemy.x,enemy.y) <= ATTACK_RANGE){
        spawnEnemy();
    } else {
        player.targetX = x;
        player.targetY = y;
    }
});

loop();
</script>

</body>
</html>
